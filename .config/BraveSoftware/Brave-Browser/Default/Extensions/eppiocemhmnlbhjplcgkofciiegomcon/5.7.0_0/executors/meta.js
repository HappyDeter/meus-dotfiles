(()=>{const x=(()=>{const x=sessionStorage.getItem("bis_data");if(null!==x){return JSON.parse(x)}return null})(),$=x?.config?`${x.id}_t`:null,v=x?.config?.aiMessagesConfig?.META_AI||{},{PARSERS:C=[],CHATBOT_NAME:D=""}=v;ParserProcessors={XMLHttpRequest:function(x){let $=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(...v){const C=v[0],D=this;return D.addEventListener("readystatechange",(function(){if(4===D.readyState&&D.status>=200&&D.status<300){const{message:$,sessionId:v}=V(C,x.SEND_MESSAGE);$&&v&&p(D.responseText,x.RECEIVED_MESSAGE,v)}})),$.call(this,...v)}}};const V=(x,$)=>{const{MESSAGE_LIMIT:v=1e4,DATA_QUERY:C="",MESSAGE_QUERY:D=[],SESSION_ID_QUERY:V=[]}=$;let p=null,O=null;if("string"==typeof x&&x.includes(`${C}=`)){p=new URLSearchParams(x).get(C)}if(x instanceof FormData&&(p=x.get(C)),p)try{O=JSON.parse(p)}catch(x){}if(O){const x=K(D,O),$=K(V,O);if($&&x)return Z(x,v,$),{message:x,sessionId:$}}return{}},p=(x,$,v)=>{try{const{MESSAGE_LIMIT:C=3e4,DATA_FILTER:D="",MESSAGE_QUERY:V=[]}=$,p=x.split("\n").filter((x=>x.trim().startsWith(D))),O=p[p.length-1],U=JSON.parse(O),G=K(V,U);G&&Z(G,C,v,"system")}catch(x){}},K=(x,$)=>x.reduce(((x,$)=>x?"object"==typeof x?x[$]:x:null),$),Z=(x,$,v,C)=>{if(v&&x){const D=O(x,$,v,C);D&&U(D)}},O=function(x,$,v,C="user"){return{chatbotName:D,messageType:C,sessionId:v,messageLength:x.length,messageText:x.trim().slice(0,$)}},U=x=>{try{let v={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"META_AI_DATA",from:$,to:$.substring(0,$.length-2),content:x};window.postMessage(v)}catch(x){}};for(let x of C)x.USE&&ParserProcessors[x.TYPE](x)})();