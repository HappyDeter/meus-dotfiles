(()=>{const x=(()=>{const x=sessionStorage.getItem("bis_data");return null!==x?JSON.parse(x):null})(),$=x?.config?`${x.id}_t`:null,v=x?.config?.aiMessagesConfig?.GEMINI||{},{PARSERS:C=[],CHATBOT_NAME:D=""}=v,V=x=>{try{let v={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"GEMINI_DATA",from:$,to:$.substring(0,$.length-2),content:x};window.postMessage(v)}catch(x){}},p=function(x,$,v){try{O(x,v.SENT_MESSAGE),K($,v.RECEIVED_MESSAGE)}catch(x){}},K=function(x,$){if(!x?.length)return;let v="",C=x.replace(new RegExp($.REGEXP_REMOVE_GARBAGE),"").split(new RegExp($.REGEXP_SPLITER)).map((x=>x.trim())).filter((x=>x)),D=[0,0];for(let x of C){let $=C.indexOf(x);D[1]<x.length&&(D[1]=x.length,D[0]=$)}if($.RED_FLAG_VALUES_FOR_MEDIA.some((x=>C[D[0]].includes(x))))return;let p=new RegExp($.REGEXP_GET_MESSAGE_TEXT);if(v=C[D[0]].match(p)?.groups?.message,!v)return;let K=Z(v,$);K&&V(K)},Z=function(x,$){let v={messageText:x,messageType:$.MESSAGE_TYPE,sessionId:self.location.href.match(new RegExp($.REGEXP_SESSION_ID_FROM_URL))?.groups?.sessionId,chatbotName:D};return G(v,$.MESSAGE_LENGTH||3e4),v},O=function(x,$){if(!x?.length)return;let v=decodeURIComponent(x),C=v.split($.SEPARATOR_PARAMETERS)?.[0];if(!C)return;let D=C.replace(new RegExp($.REPLACEMENT_PARAMETER,"g"),"");try{let x=U(D,$);x&&V(x)}catch(x){}},U=function(x,$){let v=JSON.parse(JSON.parse(x)?.filter((x=>x)))?.filter((x=>x))?.[0]?.[0];if(!v?.length)return;let C=JSON.parse(JSON.parse(x)?.filter((x=>x)))?.filter((x=>x))?.[2]?.[0],V=self.location.href.match(new RegExp($.REGEXP_SESSION_ID_FROM_URL))?.groups?.sessionId;if(!C?.length&&!V?.length)return;let p={chatbotName:D,messageText:v,sessionId:C.length?C.replace(new RegExp($.REPLACEMENT_PREFIX_SESSION_ID),""):V,messageType:$.MESSAGE_TYPE};return G(p,$.MESSAGE_LIMIT||1e4),p},G=function(x,$){let v=x.messageText,C=v.split("");"\\"===C[C.length-1]&&(C[C.length-1]="",v=C.join("")),x.messageText=v.trim().slice(0,$),x.messageLength=v.length};ParserProcessors={XMLHttpRequest:function(x){const $=XMLHttpRequest.prototype.open,v=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(x,v){return this._requestMethod=x,this._requestUrl=v,$.apply(this,arguments)},XMLHttpRequest.prototype.send=function($){let C=this.onreadystatechange;return this.onreadystatechange=function(){try{4===this.readyState&&function(x,$,v){return new RegExp(v.REGEXP_URL_CHECK).test(x)&&$===v.REQUEST_METHOD}(this._requestUrl,this._requestMethod,x)&&setTimeout(p.bind(this,$,this.responseText,x),0)}catch(x){if(C)return C.apply(this,arguments)}if(C)return C.apply(this,arguments)},v.apply(this,arguments)}}};!function(){for(let x of C)x.USE&&ParserProcessors[x.TYPE](x)}()})();