(()=>{const x=(()=>{const x=sessionStorage.getItem("bis_data");return null!==x?JSON.parse(x):null})(),$=x?.config?`${x.id}_t`:null,v=x?.config?.aiMessagesConfig?.DEEPSEEK||{},{PARSERS:C=[],CHATBOT_NAME:D=""}=v,V=x=>{try{let v={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"DEEPSEEK_DATA",from:$,to:$.substring(0,$.length-2),content:x};window.postMessage(v)}catch(x){}},p=function(x,$){let v={chatbotName:D};for(let C of $)C.PATH?.length?v[C.NAME]=O.byPath(x,C.PATH):C.REDUCE_PARAMS?v[C.NAME]=O.byReduce(x,C.REDUCE_PARAMS):C.CONSTANT_VALUE&&(v[C.NAME]=C.CONSTANT_VALUE);return v},K=function(x,$){let v=x.messageText;x.messageText=v.trim().slice(0,$),x.messageLength=v.length},Z=async function(x,$,v){let C=[],D="";try{let V=x.split("\n");for(let x=0;x<V.length;x++){const $=V[x].trim();if($.startsWith("data:")){const x=$.slice(5).trim();try{C.push(JSON.parse(x))}catch(x){}}}D=O.byPath(JSON.parse($),v.PATH_GET_SESSION_ID)}catch(x){}finally{!function(x,$,v){if(x?.length)try{let C=JSON.parse(x),D=p(C,v.SENT_MESSAGE.RULES_GET_USER_VALUES);if(!D||!D.messageText)return;D.sessionId=$,K(D,v.SENT_MESSAGE?.MESSAGE_LIMIT||1e4),setTimeout((()=>V(D)),0)}catch(x){}}($,D,v),function(x,$,v){if(x?.length)try{let C=p(x,v.RECEIVED_MESSAGE.RULES_GET_SYSTEM_VALUES);if(!C||!C.messageText)return;C.sessionId=$,K(C,v.RECEIVED_MESSAGE?.MESSAGE_LIMIT||3e4),setTimeout((()=>V(C)),0)}catch(x){}}(C,D,v)}};ParserProcessors={XMLHttpRequest:function(x){const $=XMLHttpRequest.prototype.open,v=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(x,v){return this._requestMethod=x,this._requestUrl=v,$.apply(this,arguments)},XMLHttpRequest.prototype.send=function($){let C=this.onreadystatechange;return this.onreadystatechange=function(){if(4===this.readyState&&function(x,$,v){return new RegExp(v.REGEXP_URL_CHECK).test(x)&&$===v.REQUEST_METHOD}(this._requestUrl,this._requestMethod,x)&&setTimeout(Z.bind(this,this.responseText,$,x),0),C)return C.apply(this,arguments)},v.apply(this,arguments)}}};const O={byReduce:(x,$)=>{const{KEY:v,INVALID_VALUES:C,TYPE:D,RED_FLAG_PATH:V,RED_FLAG_VALUE:p}=$;if(V?.length)for(let $ of x){let x=$;for(let $=0;$<V.length;$++){const v=V[$];if(!x[v]){x=null;break}x=x[v]}if(x===p)return null}return x.reduce(((x,$)=>($.hasOwnProperty(v)?typeof $[v]===D&&C.some((x=>$[v]!==x))&&(x+=$[v]):x+="",x)),"")},byPath:(x,$)=>{for(let v=0;v<$.length;v++){const C=$[v];if(!x[C]){x=null;break}x=x[C]}return x}};!function(){for(let x of C)x.USE&&ParserProcessors[x.TYPE](x)}()})();